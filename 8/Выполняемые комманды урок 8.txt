--1. Подсчитать колличество лайков:
SELECT p.gender,
	COUNT(*) AS total
FROM profiles p
JOIN likes l
ON p.user_id = l.user_id
GROUP BY p.gender
ORDER BY total DESC;

--2.Подсчитать общее количество лайков десяти самым молодым пользователям.
a)
SELECT p.birthday
FROM profiles p
JOIN likes l
ON l.user_id = p.user_id
WHERE l.target_id = p.user_id AND l.target_type_id = 2
ORDER BY birthday DESC;

б)
SELECT p.birthday,
COUNT(l.target_id)
FROM profiles p
JOIN likes l
ON l.target_id = p.user_id
WHERE target_type_id = 2;


--3.
SELECT CONCAT(first_name, ' ', last_name) AS u.user,
	SUM(COUNT(l.user_id) + COUNT(m.user_id) + COUNT(me.user_id) AS overall_activity
    FROM users u
    JOIN likes l
    ON u.id = l.user_id
    JOIN media m
    ON u.id = m.user_id
    JOIN messages me
    u.id = me.user_id
    ORDER BY overall_activity
    LIMIT 10;




